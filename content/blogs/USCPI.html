---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-10-20"
description: How has the CPI and its components changed over the last few years? # the title that will show up once someone gets to this page
draft: false
image: cpi.jpg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: USCPI # slug is the shorthand URL address... no spaces plz
title: How has the CPI and its components changed over the last few years?
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="how-has-the-cpi-and-its-components-changed-over-the-last-few-years" class="section level1">
<h1>How has the CPI and its components changed over the last few years?</h1>
<p>Remember how we used the tidyqant package to download CPI data. In this exercise, I would like you to do the following:</p>
<ol style="list-style-type: decimal">
<li>You can find <a href="https://fredaccount.stlouisfed.org/public/datalist/843">CPI components at FRED</a>. You should adapt the code from German polls to scrape the FRED website and pull all of the CPI components into a vector. FIY, the list of components is the second table in that webpage.</li>
<li>Once you have a vector of components, you can then pass it to <code>tidyquant::tq_get(get = "economic.data", from =  "2000-01-01")</code> to get all data since January 1, 2000</li>
<li>Since the data you download is an index with various starting dates, you need to calculate the yearly, or 12-month change. To do this you need to use the <code>lag</code> function, and specifically, <code>year_change = value/lag(value, 12) - 1</code>; this means you are comparing the current monthâ€™s value with that 12 months ago lag(value, 12).</li>
<li>I want you to order components so the higher the yearly change, the earlier does that component appear.</li>
<li>You should also make sure that the <strong>All Items</strong> CPI (CPIAUCSL) appears first.</li>
<li>Add a <code>geom_smooth()</code> for each component to get a sense of the overall trend.
1 You may want to colour the points according to whether yearly change was positive or negative.</li>
</ol>
<pre><code>## Rows: 12,753
## Columns: 11
## $ symbol          &lt;chr&gt; &quot;CUSR0000SAH21&quot;, &quot;CUSR0000SAH21&quot;, &quot;CUSR0000SAH21&quot;, &quot;CU~
## $ date            &lt;date&gt; 2000-01-01, 2000-02-01, 2000-03-01, 2000-04-01, 2000-~
## $ price           &lt;dbl&gt; 116, 119, 118, 118, 118, 121, 124, 123, 126, 129, 128,~
## $ year_change     &lt;dbl&gt; -0.40170, -0.38548, -0.42120, -0.46065, -0.49271, -0.5~
## $ avg_year_change &lt;dbl&gt; 0.00463, 0.00463, 0.00463, 0.00463, 0.00463, 0.00463, ~
## $ title           &lt;fct&gt; &quot;Household Energy&quot;, &quot;Household Energy&quot;, &quot;Household Ene~
## $ vintage_date    &lt;chr&gt; &quot;Current&quot;, &quot;Current&quot;, &quot;Current&quot;, &quot;Current&quot;, &quot;Current&quot;,~
## $ units           &lt;chr&gt; &quot;Index 1982-1984=100&quot;, &quot;Index 1982-1984=100&quot;, &quot;Index 1~
## $ freq            &lt;chr&gt; &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;,~
## $ seas_adj        &lt;chr&gt; &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, &quot;SA&quot;, ~
## $ updated         &lt;chr&gt; &quot;2021-10-13&quot;, &quot;2021-10-13&quot;, &quot;2021-10-13&quot;, &quot;2021-10-13&quot;~</code></pre>
<pre class="r"><code>ggplot(econ_data_detailed, aes(x=date, y = year_change)) +
  geom_point(aes(color = factor(year_change &lt;= 0), alpha = 0.1)) +
  #geom_point(aes(color=&quot;negative&quot;, alpha = 0.1)) +
  geom_smooth(type=&quot;loess&quot;, color=&quot;lightblue&quot;) +
  facet_wrap(~title, scales=&quot;free&quot;) +
  labs(x = &quot;Year&quot;,
       y = &quot;YoY % Change&quot;,
       title = &quot;Yearly change of US CPI (All Items) and its components&quot;,
       subtitle = &quot;YoY change being positive or negative&quot;) +
  scale_color_manual(values = c(&quot;red&quot;, &quot;lightblue&quot;)) +
  theme(legend.position = &quot;none&quot;) +
  scale_y_continuous(labels = scales::percent) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="/blogs/USCPI_files/figure-html/unnamed-chunk-1-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
